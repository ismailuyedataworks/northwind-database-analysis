Monthly Sales Trend
/*
 * This query analyze monthly sales, by using the orderdate from the orders table.
 * Join orders and order_details tables to calculate the total sales for each month.
 */
SELECT
    TO_CHAR(o.orderdate, 'Month') AS month_name,
    ROUND(SUM(od.unitprice * od.quantity * (1 - od.discount))::numeric, 1) AS total_sales
FROM
    orders o
JOIN
    order_details od ON o.orderid = od.orderid
GROUP BY
    TO_CHAR(o.orderdate, 'Month'), DATE_PART('Month', o.orderdate)
ORDER BY
    total_sales DESC;
