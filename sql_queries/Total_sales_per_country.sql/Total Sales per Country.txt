Total Sales per Country
/*
 * This query find the sales per country, by joining the orders and customers tables,      
 * grouping by shipcountry and summing the total sales.
 */
SELECT 
	c.country, ROUND(SUM(od.unitprice * od.quantity *(1-od.discount))::numeric, 1) AS Total_sales
FROM 
	customers c
JOIN 
	orders o ON c.customerid = o.customerid
JOIN
	order_details od ON o.orderid = od.orderid
GROUP BY
	c.country
ORDER BY
	Total_sales DESC;

--Alternatively; 

SELECT
    o.shipcountry,
    ROUND(SUM(od.unitprice * od.quantity * (1 - od.discount))::numeric, 1) AS total_sales
FROM
    orders o
JOIN
    order_details od ON o.orderid = od.orderid
GROUP BY
    o.shipcountry
ORDER BY
    total_sales DESC;