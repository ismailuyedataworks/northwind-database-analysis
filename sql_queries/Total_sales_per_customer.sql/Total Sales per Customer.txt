Total Sales per Customer	
/*
 * This query calculates the total sales for each customer by joining the
 * customers, orders, and order_details tables.
 */

SELECT
	c.companyname,
	c.contactname,
	ROUND(SUM(unitprice * quantity * (1 - od.discount))::numeric, 1) AS Total_sales
FROM
	customers c
INNER JOIN
	orders o ON c.customerid = o.customerid
INNER JOIN
	order_details od ON o.orderid = od.orderid
GROUP BY
	c.companyname,
	c.contactname
ORDER BY
	Total_sales DESC;	
